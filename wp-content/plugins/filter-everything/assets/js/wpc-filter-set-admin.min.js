function uniqId(e,t){var i;void 0===e&&(e="");var l=function(e,t){return t<(e=parseInt(e,10).toString(16)).length?e.slice(e.length-t):t>e.length?Array(t-e.length+1).join("0")+e:e},n="undefined"!=typeof window?window:global;n.$locutus=n.$locutus||{};var s=n.$locutus;return s.php=s.php||{},s.php.uniqidSeed||(s.php.uniqidSeed=Math.floor(123456789*Math.random())),s.php.uniqidSeed++,i=e,i+=l(parseInt((new Date).getTime()/1e3,10),8),i+=l(s.php.uniqidSeed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}!function(e){"use strict";let t=!1;function i(i){let l=e("#publishing-action .spinner"),a={};return l.addClass("is-active"),a.validateData=function(e){for(var t={},i=e.find("select, textarea, input").serializeArray(),l=0;l<i.length;l++)y(t,i[l].name,i[l].value);return t}(i),wp.ajax.post("wpc-validate-filters",a).always(function(){l.removeClass("is-active")}).done(function(e){t=!0,i.submit()}).fail(function(t){let i=[],l="";void 0!==t.errors&&(e.each(t.errors,function(t,a){void 0!==a.id?(n(a.id,a.message),s(l=e("#"+a.id).parents(".wpc-filter-item")),e("#"+a.id).parents(".wpc-filter-additional-fields").length>0&&l.find(".wpc-filter-additional-fields").slideDown({duration:200,complete:function(){e(this).addClass("wpc-opened")}})):i.push(a.message)}),i.length<1&&i.push("Error: Set was not saved."),function(t){let i=e("form#post"),l="";e.each(t,function(e,t){l+="<p>"+t+"</p>"});let n='<div id="message" class="error notice notice-error is-dismissible">'+l+'<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button></div>';void 0!==i&&(e("#message").length>0&&e("#message").remove(),i.before(n))}(i))}),!1}function l(e){e.fadeTo(100,0,function(){e.slideUp(100,function(){e.remove()})})}function n(t,i){let l=e("#"+t),n='<div class="wpc-field-notice wpc-field-notice-error"><p>'+i+"</p></div>";void 0!==l&&l.before(n)}function s(e){let t=e.find(".wpc-filter-head"),i=t.next(".wpc-filter-body");t.addClass("wpc-opened"),i.slideDown({duration:200,complete:function(){i.addClass("wpc-opened")}})}function a(t,i){let l="",n=function(t,i){let l=[],n="",s=["post_meta","post_meta_num","post_meta_exists"];return t.length>0&&(t.each(function(){n=e(this).val(),e(this).attr("id")!=i.attr("id")&&(s.includes(n)||l.push(e(this).val()))}),l)}(e(".wpc-field-entity"),t),s=function(){if(void 0!==wpcSetVars.postTypesTaxList){let t=e("#wpc_set_fields-post_type").val(),i=[],l=[];return void 0!==wpcSetVars.postTypesTaxList[t]&&e.each(wpcSetVars.postTypesTaxList[t],function(e,t){i.push(t.name)}),e.each(wpcSetVars.postTypesTaxList,function(n,s){n!==t&&e.each(s,function(e,t){!1===i.includes(t.name)&&l.push(t.name)})}),l}return[]}();return t.find("option").each(function(){"post_meta_exists"===(l=e(this).val())&&wpcSetVars.filtersPro<1||(n.includes(l)||s.includes(l)?e(this).attr("disabled","disabled"):e(this).removeAttr("disabled"))}),"disabled"!==t.find("option:selected").attr("disabled")||i||t.find("option:not([disabled]):first").prop("selected",!0).trigger("change"),!0}function d(t){let i=0;e(".wpc-new-filter-item .wpc-field-entity").each(function(){let t=e(this),l=!1;e(this).attr("id")==t.attr("id")&&(l=!0),setTimeout(function(){a(t,l)},i),i+=100})}function p(t){if(wpcSetVars.filtersPro<1)return!0;if(""===t)return!0;l(e(".wpc-field-notice"));let i=e(".wpc_set_fields-wp_filter_query-wrap").children(".spinner"),n=e("#wpc_set_fields-post_type").val(),s={};s._wpnonce=e("#wpc_set_nonce").val(),s.wpPageType=e("#wpc_set_fields-wp_page_type").val(),s.postType=n,s.postId=e("#post_ID").val(),s.action="wpc_get_wp_queries",e.ajax({method:"POST",data:s,url:t,dataType:"html",beforeSend:function(){i.addClass("is-active"),e(".wpc-location-preview").attr("href",t)},complete:function(){i.removeClass("is-active")},success:function(t){let i=e(t).find("#wpc_set_fields-wp_filter_query"),l=e(t).find("#wpc_query_vars");""!==i&&i.length>0&&e("#"+wpcSetVars.wPQuerySelectId).replaceWith(i),l.length>0&&e("#wpc_query_vars").replaceWith(l)},error:function(e){}})}function o(t){let i=e(".wpc_set_fields-post_name-wrap").children(".spinner");i.addClass("is-active"),l(e(".wpc-field-notice"));let s=e("#wpc_set_fields-post_type").val(),a={};a._wpnonce=e("#wpc_set_nonce").val(),a.wpPageType=t,a.postType=s,a.postId=e("#post_ID").val(),wp.ajax.post("wpc-get-set-location-terms",a).always(function(){i.removeClass("is-active")}).done(function(t){let i=e(t.html).find("#wpc_set_fields-post_name");e("#wpc_set_fields-post_name").replaceWith(i);let l=e("option:selected",e("#wpc_set_fields-post_name")).data("link");void 0!==l&&p(l)}).fail(function(e){void 0!==e&&n("wpc_set_fields-post_name",e.message)})}function c(t,i){let l;t.on("input",function(){l=e(this).val(),i.text(l)})}function r(){e(".wpc-filter-item").each(function(t,i){var l=t+1;e(i).find(".wpc-menu-order-field").attr("value",l),e(i).find(".wpc-filter-sortable-handle").text(l)})}function f(){e(".wpc-filter-item").length>0?e(".wpc-no-filters").hide():e(".wpc-no-filters").show()}function w(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid"),n="";i.startsWith("taxonomy_pa_")&&(n=" taxonomy-product-attribute"),-1!==i.indexOf("taxonomy")&&(i="taxonomy"),e("#wpc-filter-id-"+l+" .wpc-form-fields-table").attr("class","wpc-form-fields-table wpc-filter-"+i+n)}function u(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");if(void 0!==wpcSetVars.filterSlugs[i]){let t=wpcSetVars.filterSlugs[i];e("#wpc_filter_fields-"+l+"-slug").val(t).attr("readonly","readonly").trigger("input")}else e("#wpc_filter_fields-"+l+"-slug").val("").removeAttr("readonly").trigger("input")}function _(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");i.includes("taxonomy_pa")?(e("#wpc_filter_fields-"+l+'-orderby option[value="menuasc"]').removeAttr("disabled"),e("#wpc_filter_fields-"+l+'-orderby option[value="menudesc"]').removeAttr("disabled")):(e("#wpc_filter_fields-"+l+'-orderby option[value="menuasc"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-orderby option[value="menudesc"]').attr("disabled","disabled"))}function h(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");"post_meta_num"===i?(e("#wpc_filter_fields-"+l+'-view option:not([value="range"])').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-view option[value="range"]').removeAttr("disabled").prop("selected",!0)):(e("#wpc_filter_fields-"+l+"-view option").removeAttr("disabled"),e("#wpc_filter_fields-"+l+"-view option:not([disabled]):first").prop("selected",!0),e("#wpc_filter_fields-"+l+'-view option[value="range"]').attr("disabled","disabled"))}function m(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");e("#wpc-filters-list").attr("data-posttype");-1!==i.indexOf("taxonomy")&&e.each(wpcSetVars.postTypesTaxList,function(t,n){e.each(n,function(t,n){n.name===i&&(n.hierarchical?e("#wpc-filter-id-"+l+" .wpc-field-hierarchy-tr").show():e("#wpc-filter-id-"+l+" .wpc-field-hierarchy-tr").hide())})})}function v(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");"post_meta"===i||"post_meta_num"===i||"post_meta_exists"===i?e("#wpc_filter_fields-"+l+"-e_name").val("").removeAttr("readonly").parents(".wpc-field-ename-tr").show():e("#wpc_filter_fields-"+l+"-e_name").parents(".wpc-field-ename-tr").hide(),"post_meta_num"===i?e("#wpc_filter_fields-"+l+"-in_path").prop("checked",!1):e("#wpc_filter_fields-"+l+"-in_path").prop("checked",!0)}function g(t,i,n){l(e(".wpc-field-notice"));let s={},a=e("#wpc_filter_fields-"+i+"-exclude");s._wpnonce=e("#wpc_set_nonce").val(),s.fid=i,s.entity=t,void 0!==n&&(s.ename=n);let d=a.parent(".wpc-after-spinner-container").prev(".spinner");d.addClass("is-active"),wp.ajax.post("wpc-load-exclude-terms",s).always(function(){d.removeClass("is-active")}).done(function(e){void 0!==e.fid&&(a.select2("destroy"),a.html(""),a.select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder,data:e.terms,disabled:!1}))}).fail(function(e){})}function y(e,t,i){var l=(t=t.replace("[]","[%%index%%]")).match(/([^\[\]])+/g);if(l)for(var n,s=l.length,a=e,d=0;d<s;d++){var p=String(l[d]);d==s-1?"%%index%%"===p?a.push(i):a[p]=i:("%%index%%"===l[d+1]?(n=a[p],Array.isArray(n)||(a[p]=[])):b(a[p])||(a[p]={}),a=a[p])}}function b(e){return"object"==typeof e}e(document).ready(function(){e("form#post").on("submit",function(n){l(e(".wpc-field-notice")),l(e("#message")),function(e){let t=e.find(".wpc-filter-head"),i=t.next(".wpc-filter-body");t.removeClass("wpc-opened"),i.slideUp({duration:200,complete:function(){i.removeClass("wpc-opened")}})}(e(".wpc-filter-item")),t||(n.preventDefault(),i(e(this)))}),e(".wpc-add-filter").on("click",function(t){t.preventDefault();var i=e("#wpc-new-filter").html(),l=e(i),n="wpc_new_id",d=uniqId("filter_"),p=function(e,t){return t.replace(n,d)};l.find('[id*="wpc_new_id"]').attr("id",p),l.find('[for*="wpc_new_id"]').attr("for",p),l.find('[name*="wpc_new_id"]').attr("name",p),l.data("fid",d),l.attr("id","wpc-filter-id-"+d),e(".wpc-filters-list").append(l);let o=l.find(".wpc-field-entity");u(o),v(o),w(o),h(o),_(o),a(o),m(o),l.find(".wpc-field-exclude").select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder}),1===e(".wpc-filter-item").length&&o.trigger("change"),e(".wpc-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200,keepAlive:!0,maxWidth:"220px"}),s(l),r(),f()}),e(".wpc-form-fields-table:not(.wpc-filter-post_meta_num) .wpc-field-exclude, .wpc-form-fields-table:not(.wpc-filter-post_meta_exists) .wpc-field-exclude").select2({width:"100%",placeholder:wpcSetVars.excludePlaceholder}),e("body").on("click",".notice-dismiss",function(t){t.preventDefault(),l(e("#message"))}),e("body").on("click",".wpc-button-link-delete",function(t){t.preventDefault(),e(this).parents(".wpc-filter-label-td").next(".wpc-filter-field-td").children(".wpc-filter-delete-wrapper").css("visibility","visible")}),e("body").on("click",".wpc-filter-delete-cancel",function(t){t.preventDefault(),l(e(".wpc-field-notice")),e(this).parents(".wpc-filter-delete-wrapper").css("visibility","hidden")}),e("body").on("click",".wpc-done-action",function(t){e(this).parents(".wpc-filter-body").slideToggle(200).toggleClass("wpc-opened").children(".wpc-filter-additional-fields").removeClass("wpc-additional-opened").hide(),e(this).parents(".wpc-filter-body").prev(".wpc-filter-head").toggleClass("wpc-opened"),e(this).parents(".wpc-filter-field-td").next(".wpc-filter-field-td").find(".wpc-filter-delete-wrapper").css("visibility","hidden")}),e("body").on("click",".wpc-title-action",function(t){let i=e(this).parent(".wpc-filter-head"),l=i.next(".wpc-filter-body");i.toggleClass("wpc-opened"),l.slideToggle(200).toggleClass("wpc-opened").children(".wpc-filter-additional-fields").removeClass("wpc-additional-opened").hide(),l.find(".wpc-filter-delete-wrapper").css("visibility","hidden");let n=l.find(".wpc-more-options-toggle");n.hasClass("wpc-opened")&&n.trigger("click")}),e("body").on("click",".wpc-more-options-toggle",function(t){t.preventDefault(),e(this).text()===wpcSetVars.moreOptions?e(this).text(wpcSetVars.lessOptions):e(this).text(wpcSetVars.moreOptions),e(this).toggleClass("wpc-opened"),e(this).parents(".wpc-filter-body").find(".wpc-filter-additional-fields").slideToggle(200).toggleClass("wpc-additional-opened")}),e("body").on("change",".wpc-field-entity",function(t){let i=e(this);d(),u(i),v(i),function(t){let i=t.val(),l=t.parents(".wpc-filter-item").data("fid");"author_author"===i||"post_meta_exists"===i?(e("#wpc_filter_fields-"+l+'-logic option[value="and"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-logic option[value="or"]').prop("selected",!0)):"post_meta_num"===i?(e("#wpc_filter_fields-"+l+'-logic option[value="or"]').attr("disabled","disabled"),e("#wpc_filter_fields-"+l+'-logic option[value="and"]').prop("selected",!0)):(e("#wpc_filter_fields-"+l+'-logic option[value="and"]').removeAttr("disabled"),e("#wpc_filter_fields-"+l+'-logic option[value="or"]').removeAttr("disabled"))}(i),w(i),h(i),_(i),m(i);let l=e(this).val(),n=e(this).parents(".wpc-filter-item").data("fid");if("post_meta"===l||"post_meta_num"===l||"post_meta_exists"===l){e("#wpc_filter_fields-"+n+"-exclude").select2({disabled:!0,width:"100%"})}else g(l,n);let s=e(this).find("option:selected").text();e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-entity").text(s)}),e("body").on("input change",".wpc-field-ename",function(){let t=e(this).val(),i=e(this).parents(".wpc-filter-item").data("fid"),l=e("#wpc_filter_fields-"+i+"-entity").val(),n="",s=wpcSetVars.filterSlugs;void 0!==s[n="post_meta_num"===l?"post_meta_num_"+t:"post_meta_exists"===l?"post_meta_exists_"+t:"post_meta_"+t]?(e("#wpc_filter_fields-"+i+"-slug").val(s[n]).trigger("input"),"post_meta_num"!==l&&g(l,i,t)):(e("#wpc_filter_fields-"+i+"-slug").val("").trigger("input"),e("#wpc_filter_fields-"+i+"-exclude").select2({disabled:!0,width:"100%"}))}),e("body").on("input",".wpc-field-value-step",function(){e(this).val(e(this).val().replace(/,/g,".")),e(this).val(e(this).val().replace(/[^\d\.]/g,""))}),e("body").on("input",".wpc-field-slug",function(){let t=e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-slug");c(e(this),t)}),e("body").on("input",".wpc-field-label",function(){let t=e(this).parents(".wpc-filter-item").find(".wpc-filter-head li.wpc-filter-label");c(e(this),t)}),e("body").on("change",".wpc-field-view",function(){let t=e(this).find("option:selected").text(),i=e(this).find("option:selected").val(),l=e(this).parents(".wpc-filter-item");l.find(".wpc-filter-head li.wpc-filter-view").text(t),["checkboxes","radio","labels"].includes(i)?l.find(".wpc-field-search-tr").show():l.find(".wpc-field-search-tr").hide()}),e(".wpc-filter-set-wrapper .wpc-filters-list").sortable({items:"> div.wpc-filter-item",delay:150,placeholder:"wpc-filter-item-shadow",refreshPositions:!0,cursor:"move",handle:".wpc-filter-order",axis:"y",update:function(e,t){r()},start:function(t,i){e(this);var l=i.item.children(".wpc-filter-head"),n=i.item.children(".wpc-filter-body");n.hasClass("wpc-opened")&&(n.removeClass("wpc-opened").hide(),l.removeClass("wpc-opened"),e(this).sortable("refreshPositions")),e(".wpc-filter-item-shadow").css("min-height",l.height()+"px")}}),e(".wpc-filter-set-wrapper .wpc-filters-list").keydown(function(e){65==e.keyCode&&(e.ctrlKey||e.metaKey)&&e.target.select()}),e(".wpc-filters-list").disableSelection(),e("body").on("click",".wpc-filter-delete",function(){l(e(".wpc-field-notice"));let t=e(this).prev(".spinner");t.addClass("is-active");let i={};if(i._wpnonce=e("#wpc_set_nonce").val(),i.fid=e(this).data("fid"),"wpc_new_id"===i.fid){e(this).parents(".wpc-filter-item").slideUp({duration:200,complete:function(){e(this).remove(),r(),f()}})}wp.ajax.post("wpc-delete-filter",i).always(function(){t.removeClass("is-active")}).done(function(t){void 0!==t&&void 0!==t.fid&&e("#wpc-filter-id-"+t.fid).slideUp({duration:200,complete:function(){e(this).remove(),r(),f(),d()}})}).fail(function(e){void 0!==e&&n("wpc-filter-delete-wrapper-"+e.fid,e.message)})}),e("body").on("change","#wpc_set_fields-post_type",function(){if(e("#wpc-filters-list").attr("data-posttype",e(this).val()),wpcSetVars.filtersPro<1)return!0;a(e(".wpc-new-filter-item .wpc-field-entity")),l(e(".wpc-field-notice"));let t=e("#wpc_set_fields-wp_page_type").val();void 0!==t&&o(t)}),e("body").on("change","#wpc_set_fields-wp_page_type",function(){o(e(this).val())}),e(".wpc-error.is-dismissible").each(function(){var t=e(this),i=t.find(".notice-dismiss");i.on("click",function(e){e.preventDefault(),t.fadeTo(100,0,function(){t.slideUp(100,function(){t.remove()})})}),t.append(i)}),e("body").on("change","#wpc_set_fields-post_name",function(t){let i=e("option:selected",this).data("link");void 0!==i&&p(i)});let y=e("option:selected",e("#wpc_set_fields-post_name")).data("link");void 0!==y&&y&&p(y)})}(jQuery);